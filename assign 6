#include <iostream>
using namespace std;

/* -----------------------------------------------------------
   DOUBLY LINKED LIST (DLL)
----------------------------------------------------------- */

struct DNode {
    char data;
    DNode* prev;
    DNode* next;
};
DNode* dhead = NULL;

// Create node
DNode* dcreate(char x) {
    DNode* n = new DNode;
    n->data = x;
    n->prev = n->next = NULL;
    return n;
}

// Insert at beginning
void dinsertBeg(char x) {
    DNode* n = dcreate(x);
    if(!dhead) { dhead = n; return; }
    n->next = dhead;
    dhead->prev = n;
    dhead = n;
}

// Insert at end
void dinsertEnd(char x) {
    DNode* n = dcreate(x);
    if(!dhead) { dhead = n; return; }
    DNode* temp = dhead;
    while(temp->next) temp = temp->next;
    temp->next = n;
    n->prev = temp;
}

// Insert before a given node
void dinsertBefore(char value, char x) {
    if(!dhead) return;
    if(dhead->data == value) { dinsertBeg(x); return; }

    DNode* temp = dhead;
    while(temp && temp->data != value) temp = temp->next;
    if(!temp) return;

    DNode* n = dcreate(x);
    n->prev = temp->prev;
    n->next = temp;
    temp->prev->next = n;
    temp->prev = n;
}

// Insert after a given node
void dinsertAfter(char value, char x) {
    DNode* temp = dhead;
    while(temp && temp->data != value) temp = temp->next;
    if(!temp) return;

    DNode* n = dcreate(x);
    n->next = temp->next;
    n->prev = temp;
    if(temp->next) temp->next->prev = n;
    temp->next = n;
}

// Delete a specific node
void ddeleteValue(char x) {
    if(!dhead) return;

    if(dhead->data == x) {
        DNode* t = dhead;
        dhead = dhead->next;
        if(dhead) dhead->prev = NULL;
        delete t;
        return;
    }

    DNode* temp = dhead;
    while(temp && temp->data != x)
        temp = temp->next;

    if(!temp) return;

    if(temp->next) temp->next->prev = temp->prev;
    temp->prev->next = temp->next;

    delete temp;
}

// Search in DLL
bool dsearch(char x) {
    DNode* temp = dhead;
    while(temp) {
        if(temp->data == x) return true;
        temp = temp->next;
    }
    return false;
}

// Size of DLL
int dsize() {
    int count = 0;
    DNode* temp = dhead;
    while(temp) { count++; temp = temp->next; }
    return count;
}

// Check palindrome DLL
bool disPalindrome() {
    if(!dhead) return true;

    DNode* left = dhead;
    DNode* right = dhead;
    while(right->next) right = right->next;

    while(left != right && right->next != left) {
        if(left->data != right->data) return false;
        left = left->next;
        right = right->prev;
    }
    return true;
}

/* -----------------------------------------------------------
   CIRCULAR LINKED LIST (CLL)
----------------------------------------------------------- */

struct CNode {
    int data;
    CNode* next;
};
CNode* chead = NULL;

// Create
CNode* ccreate(int x) {
    CNode* n = new CNode;
    n->data = x;
    n->next = NULL;
    return n;
}

// Insert at beginning
void cinsertBeg(int x) {
    CNode* n = ccreate(x);

    if(!chead) {
        chead = n;
        n->next = n;
        return;
    }

    CNode* temp = chead;
    while(temp->next != chead)
        temp = temp->next;

    n->next = chead;
    temp->next = n;
    chead = n;
}

// Insert at end
void cinsertEnd(int x) {
    CNode* n = ccreate(x);
    if(!chead) {
        chead = n;
        n->next = n;
        return;
    }

    CNode* temp = chead;
    while(temp->next != chead)
        temp = temp->next;

    temp->next = n;
    n->next = chead;
}

// Insert after value
void cinsertAfter(int value, int x) {
    if(!chead) return;

    CNode* temp = chead;
    do {
        if(temp->data == value) {
            CNode* n = ccreate(x);
            n->next = temp->next;
            temp->next = n;
            return;
        }
        temp = temp->next;
    } while(temp != chead);
}

// Insert before value
void cinsertBefore(int value, int x) {
    if(!chead) return;

    if(chead->data == value) {
        cinsertBeg(x);
        return;
    }

    CNode* temp = chead;
    while(temp->next != chead && temp->next->data != value)
        temp = temp->next;

    if(temp->next->data == value) {
        CNode* n = ccreate(x);
        n->next = temp->next;
        temp->next = n;
    }
}

// Delete specific node
void cdeleteValue(int x) {
    if(!chead) return;

    // Deleting head
    if(chead->data == x) {
        if(chead->next == chead) { delete chead; chead = NULL; return; }

        CNode* temp = chead;
        while(temp->next != chead)
            temp = temp->next;

        CNode* del = chead;
        temp->next = chead->next;
        chead = chead->next;
        delete del;
        return;
    }

    // Delete middle/last
    CNode* temp = chead;
    while(temp->next != chead && temp->next->data != x)
        temp = temp->next;

    if(temp->next->data == x) {
        CNode* del = temp->next;
        temp->next = del->next;
        delete del;
    }
}

// Search in CLL
bool csearch(int x) {
    if(!chead) return false;

    CNode* temp = chead;
    do {
        if(temp->data == x) return true;
        temp = temp->next;
    } while(temp != chead);
    return false;
}

// Display CLL + repeat head at end
void cdisplayRepeatHead() {
    if(!chead) return;

    CNode* temp = chead;
    do {
        cout << temp->data << " ";
        temp = temp->next;
    } while(temp != chead);
    cout << chead->data << endl;
}

// Size of CLL
int csize() {
    if(!chead) return 0;

    int count = 0;
    CNode* temp = chead;
    do {
        count++;
        temp = temp->next;
    } while(temp != chead);
    
    return count;
}

// Check if linked list is circular (generic)
bool isCircular(CNode* head) {
    if(!head) return false;

    CNode* temp = head->next;
    while(temp && temp != head)
        temp = temp->next;

    return (temp == head);
}


/* -----------------------------------------------------------
   MAIN (Demonstration Only)
----------------------------------------------------------- */

int main() {

    // Sample demonstration for circular list output (Q2)
    cinsertEnd(20);
    cinsertEnd(100);
    cinsertEnd(40);
    cinsertEnd(80);
    cinsertEnd(60);

    cout << "Circular List Output (head repeated): ";
    cdisplayRepeatHead();   // 20 100 40 80 60 20

    // Check circular (Q5)
    cout << "Is circular? " << (isCircular(chead) ? "True" : "False") << endl;

    // Sample DLL Palindrome (Q4)
    dinsertEnd('r');
    dinsertEnd('a');
    dinsertEnd('d');
    dinsertEnd('a');
    dinsertEnd('r');

    cout << "DLL Palindrome: " << (disPalindrome() ? "True" : "False") << endl;

    // Size checks
    cout << "Size of DLL: " << dsize() << endl;
    cout << "Size of CLL: " << csize() << endl;

    return 0;
}
